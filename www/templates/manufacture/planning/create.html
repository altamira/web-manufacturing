<div class="loding_div" ng-show="loading">
    <div id="loadingProgressG">
        <div id="loadingProgressG_1" class="loadingProgressG">
        </div>
    </div>
</div>
<ion-pane>
    <ion-header-bar class="bar-calm">
        <div class="buttons header-margin">
            <button type="button" class="button fa-arrow-left" ng-click="createManPlanningModalShow()"></button>
            <span class="btn-separator"></span>
            <h4 style="color: #ffffff;margin-top: 5px;">&nbsp;Planejamento de Producao&nbsp;</h4>
            <span class="btn-separator"></span>
            <button class="button fa-check" ng-click="openStartDateModal()" ></button>
            <!--            <span class="btn-separator"></span>
                        <button type="button" class="button fa-check-square-o-header" ng-click="checkAllDelivery()"></button>
                        <button type="button" class="button fa-square-o-header" ng-click="uncheckAllDelivery()"></button>
                        <span class="btn-separator"></span>
                        <button type="button" class="button fa-plus-square-o-header" ng-click="expandAll()"></button>
                        <button type="button" class="button fa-minus-square-o-header" ng-click="collapseAll()"></button>-->
        </div>
        <div class="header-col-right">{{totalWeight | setDecimal:2}} kg</div>
    </ion-header-bar>
    <ion-content>
        <div class="row bar-calm-top">
            <div class="col col-50" style="display: none">
                <div class="button-bar bar-calm">
                    <a class="button topBtnRadius month" ng-click='monthlyView()' id="monthlyShowBtn">Mensal</a>
                    <a class="button" ng-click='weeklyView()' id="weeklyShowBtn">Semanal</a>
                </div>
            </div>
            <div class="col col-50 col-offset-50" style="padding-right: 20px;">
                <div class="button-bar top-view-change-btn" style="float: right;width: 140px;">
                    <a class="button button-bar-unselected button-bar-selected fa-component-switch" ng-click="listView()" id="listShowBtn"></a>
                    <a class="button button-bar-unselected fa-list-alt" ng-click="formView()" id="formShowBtn"></a>
                    <a class="button button-bar-unselected fa-th" ng-click="gridView()" id="gridShowBtn"></a>
                </div>
            </div>
        </div>
        <div class="row planning-col">
            <div class="col tableTitle align-right">Hoje : {{today}}</div>
        </div>
        <div id="list_view">
            <div class="row" ng-repeat="operation in operationData | orderBy : 'id'">
                <div id="item_repeat" class="width-100 create-list">
                    <div class="row">
                        <div class="col">
                            <div class="list">
                                <a class="process-item-list item-icon-left item-icon-right color" style="font-weight: normal">
                                    <i class="icon left-icon plus-icon fa-plus-square-o" ng-click="getComponentByOperation({{operation.id}})" operationid="{{operation.id}}" style="font-size: 22px">{{operation.name}}</i>
                                    <i class="icon fa-check-square-o checkall_{{operation.id}}" ng-click="checkAllOperationDelivery({{operation.id}})" style="width: 19px; margin-left: 96%;"></i>
                                    <i class="icon right-icon fa-square-o checkall_{{operation.id}}" ng-click="uncheckAllOperationDelivery({{operation.id}})" style="width: 19px"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="width-100">
                        <div class="col row">
                            <table width="100%" border="0" cellspacing="0" cellpadding="0" class="delivery-table component_table_{{operation.id}}_{{bom.id}}_{{item.id}}">
                                <thead>
                                    <tr>
                                        <th class="edit-item-title align-center width-11"><i class="fa-calender"></i> <span>Entrega</span></th>
                                        <th class="edit-item-title width-55">Descricao</th>
                                        <th class="edit-item-title align-center width-10"><i class="fa-list-ol"></i> <span class="color">Quantidade</span></th>
                                        <th class="edit-item-title align-center width-10"><i class="fa-list-ol"></i> <span class="color">Produzir</span></th>
                                        <th class="edit-item-title align-center width-11"><i class="fa-tachometer"></i> <span class="color">Peso</span></th>
                                        <th class="edit-item-title align-center width-3">&nbsp;</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class="edit-info align-center width-11 create-date">23-10-2015</td>
                                        <td class="edit-text width-55" style="font-weight: normal">Lorem Ipsum is simply dummy text of the printing and typesetting</td>
                                        <td class="edit-info align-right width-10">50<span style="margin-left: 5px;">kg</span></td>
                                        <td class="edit-info align-right width-10">
                                            <input type="number" value="10.50" class="saldo" style="margin-bottom: 5px; text-align: right">
                                        </td>
                                        <td class="edit-info align-right width-11">400<span style="margin-left: 5px;">Kg</span></td>
                                        <td class="edit-text align-center width-3" style="font-weight: normal">
                                            <i class="icon plus-icon fa-square-o" select-components></i>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="edit-info align-center width-11 create-date">23-10-2015</td>
                                        <td class="edit-text width-55" style="font-weight: normal">Lorem Ipsum is simply dummy text of the printing and typesetting</td>
                                        <td class="edit-info align-right width-10">50<span style="margin-left: 5px;">kg</span></td>
                                        <td class="edit-info align-right width-10">
                                            <input type="number" value="10.50" class="saldo" style="margin-bottom: 5px; text-align: right">
                                        </td>
                                        <td class="edit-info align-right width-11">400<span style="margin-left: 5px;">Kg</span></td>
                                        <td class="edit-text align-center width-3" style="font-weight: normal">
                                            <i class="icon plus-icon fa-square-o" select-components></i>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="edit-info align-center width-11 create-date">23-10-2015</td>
                                        <td class="edit-text width-55" style="font-weight: normal">Lorem Ipsum is simply dummy text of the printing and typesetting</td>
                                        <td class="edit-info align-right width-10">50<span style="margin-left: 5px;">kg</span></td>
                                        <td class="edit-info align-right width-10">0 un</td>
                                        <td class="edit-info align-right width-11">0<span style="margin-left: 5px;">Kg</span></td>
                                        <td class="edit-text align-center width-3" style="font-weight: normal">
                                            <i class="icon plus-icon fa-ban"></i>
                                        </td>
                                    </tr>
<!--                                    <tr ng-repeat='component in item.component |  orderBy : "id"'>
                                        <td class="edit-info align-center width-11 create-date">{{component.delivery[0].delivery | getDate}}</td>
                                        <td class="edit-text width-55" style="font-weight: normal">{{component.material.description}}</td>
                                        <td class="edit-info align-right width-10">{{component.quantity.value}}<span style="margin-left: 5px;">{{component.quantity.unit.symbol}}</span></td>
                                        <td class="edit-info align-right width-10">
                                            <input type="number" id="remaining_{{operation.id}}_{{bom.id}}_{{item.id}}_{{component.id}}" value="{{component.remaining.value}}" class="saldo" style="margin-bottom: 5px; text-align: right" ng-if="component.remaining.value > 0">
                                            <input type="number" id="remaining_{{operation.id}}_{{bom.id}}_{{item.id}}_{{component.id}}" value="{{component.remaining.value}}" class="saldo" style="margin-bottom: 5px; text-align: right" ng-if="component.remaining.value < 1" readonly>
                                        </td>
                                        <td class="edit-info align-right width-11">{{component.weight.value | setDecimal:2}}<span style="margin-left: 5px;">{{component.weight.unit.symbol}}</span></td>
                                        <td class="edit-text align-center width-3 td_{{operation.id}}_{{bom.id}}_{{item.id}}_{{component.id}}" style="font-weight: normal">
                                            <i class="icon plus-icon fa-square-o" select-components operationid="{{operation.id}}" bomid="{{bom.id}}" itemid="{{item.id}}" componentid="{{component.id}}" componentqun="{{component.quantity.value}}" componentpeso="{{component.weight.value}}"></i>
                                        </td>
                                    </tr>-->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="form_view" style="display: none;">
            <div class="row" ng-repeat="operation in operationData | orderBy : 'id'">
                <div id="item_repeat" class="width-100 create-list">
                    <div class="row">
                        <div class="col">
                            <div class="list">
                                <a class="process-item-list item-icon-left item-icon-right color" style="font-weight: normal">
                                    <i class="operation_manage_button_{{operation.id}} icon left-icon plus-icon fa-plus-square-o" manage-operationsection operationid="{{operation.id}}" style="font-size: 22px">{{operation.name}}</i>
                                    <i class="icon fa-check-square-o checkall_{{operation.id}}" ng-click="checkAllOperationDelivery({{operation.id}})" style="width: 19px; margin-left: 96%;"></i>
                                    <i class="icon right-icon fa-square-o checkall_{{operation.id}}" ng-click="uncheckAllOperationDelivery({{operation.id}})" style="width: 19px"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="operation_section_{{operation.id}}" ng-if='operation.bom != ""' ng-repeat='bom in operation.bom | orderBy : "id"'>
                        <div class="row" style="padding-bottom: 0; padding-top: 0;">
                            <div class="col">
                                <div class="list">
                                    <a class="process-item-list item-icon-left item-icon-right" style="padding-left: 3%; margin-left: 15px; padding-bottom: 8px; padding-top: 0px;font-weight: normal;height: 35px">
                                        <i class="bom_manage_button_{{operation.id}}_{{bom.id}} icon plus-icon fa-plus-square-o" manage-bomsection operationid="{{operation.id}}" bomid="{{bom.id}}" style="font-size: 20px">{{bom.number}} {{bom.customer}}</i>
                                        <i class="icon fa-check-square-o checkall_{{operation.id}}_{{bom.id}}" ng-click="checkAllBomDelivery({{operation.id}}, {{bom.id}})" style="width: 19px; margin-left: 96%;"></i>
                                        <i class="icon right-icon fa-square-o checkall_{{operation.id}}_{{bom.id}}" ng-click="uncheckAllBomDelivery({{operation.id}}, {{bom.id}})" style="width: 19px"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <div class="bom_section_{{operation.id}}_{{bom.id}}" ng-if='bom.item != ""' ng-repeat='item in bom.item |  orderBy : "id"'>
                            <div class="row" style="padding-bottom: 0; padding-top: 0;">
                                <div class="col">
                                    <div class="list">
                                        <a class="process-item-list item-icon-left item-icon-right" style="padding-left: 3%; margin-left: 38px; padding-bottom: 8px; padding-top: 0px;font-weight: normal;height: 30px">
                                            <i class="item_mange_button_{{operation.id}}_{{bom.id}}_{{item.id}} icon plus-icon fa-plus-square-o" manage-itemsection operationid="{{operation.id}}" bomid="{{bom.id}}" itemid="{{item.id}}" style="padding-bottom: 7px;font-size: 18px">ITEM {{item.item}}</i>
                                            <i class="icon right-icon fa-check-square-o checkall_{{operation.id}}_{{bom.id}}_{{item.id}}" ng-click="checkAllItemDelivery({{operation.id}}, {{bom.id}}, {{item.id}})" style="width: 19px; margin-left: 96%;"></i>
                                            <i class="icon right-icon fa-square-o checkall_{{operation.id}}_{{bom.id}}_{{item.id}}" ng-click="uncheckAllItemDelivery({{operation.id}}, {{bom.id}}, {{item.id}})" style="width: 19px"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="item_section_{{operation.id}}_{{bom.id}}_{{item.id}}" ng-if='item.component != ""' style="display: none">
                                <div class="row">
                                    <div class="col">
                                        <div style="font-size: 16px;margin-left: 3%">{{item.description}}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="edit-item" ng-if='item.component != ""'>
                                <div class="col row">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="delivery-table component_table_{{operation.id}}_{{bom.id}}_{{item.id}}">
                                        <thead>
                                            <tr>
                                                <th class="edit-item-title align-center width-11"><i class="fa-calender"></i> <span>Entrega</span></th>
                                                <th class="edit-item-title width-55">Descricao</th>
                                                <th class="edit-item-title align-center width-10"><i class="fa-list-ol"></i> <span class="color">Quantidade</span></th>
                                                <th class="edit-item-title align-center width-10"><i class="fa-list-ol"></i> <span class="color">Produzir</span></th>
                                                <th class="edit-item-title align-center width-11"><i class="fa-tachometer"></i> <span class="color">Peso</span></th>
                                                <th class="edit-item-title align-center width-3">&nbsp;</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat='component in item.component |  orderBy : "id"'>
                                                <td class="edit-info align-center width-11 create-date">{{component.delivery[0].delivery | getDate}}</td>
                                                <td class="edit-text width-55" style="font-weight: normal">{{component.description}}</td>
                                                <td class="edit-info align-right width-10">{{component.quantity.value}}<span style="margin-left: 5px;">{{component.quantity.unit.symbol}}</span></td>
                                                <td class="edit-info align-right width-10">
                                                    <input type="number" id="remaining_{{operation.id}}_{{bom.id}}_{{item.id}}_{{component.id}}" value="{{component.remaining.value}}" class="saldo" style="margin-bottom: 5px; text-align: right" ng-if="component.remaining.value > 0">
                                                    <span ng-if="component.remaining.value <= 0">{{component.remaining.value}}</span>
                                                </td>
                                                <td class="edit-info align-right width-11">{{component.weight.value | setDecimal:2}}<span style="margin-left: 5px;">{{component.weight.unit.symbol}}</span></td>
                                                <td class="edit-text align-center width-3 td_{{operation.id}}_{{bom.id}}_{{item.id}}_{{component.id}}" style="font-weight: normal">
                                                    <i class="icon plus-icon fa-square-o" select-components operationid="{{operation.id}}" bomid="{{bom.id}}" itemid="{{item.id}}" componentid="{{component.id}}" componentqun="{{component.quantity.value}}" componentpeso="{{component.weight.value}}"  ng-if="component.remaining.value > 0"></i>
                                                    <i class="icon plus-icon fa-ban" operationid="{{operation.id}}" bomid="{{bom.id}}" itemid="{{item.id}}" componentid="{{component.id}}" componentqun="{{component.quantity.value}}" componentpeso="{{component.weight.value}}" ng-if="component.remaining.value <= 0"></i>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="grid_view" class="planning-detail width-100" style="display: none;" ng-controller='ManufacturePlanningGridCtrl'>
            <div class="row manufacture-grid" ng-if="finalArr != ''">
                <div class="col-25 scroll-div dataRow">
                    <table class="dataTable">
                        <tr>
                            <th class="monthTitle dataTable-title" style="border-bottom:1px solid #666;"></th>
                        </tr>
                        <tr>
                            <th style="height: 26px; text-align: left; border-right:none; border-bottom:none;">Linha de Produto</th>
                        </tr>
                        <tr ng-repeat="order in finalArr" id="{{BOM.id}}" ng-click="getShippingDetail({{order.id}})" style="cursor: pointer" ng-class-odd="'odd'" ng-class-even="'even'">
                            <td style="border-top:none;" >{{order.name}}</td>
                        </tr>
                        <tr>
                            <td style="border-top:none;  background: #00aba9; border:1px solid #666; height: 36px;" class="ng-binding"></td>
                        </tr>
                    </table>
                </div>
                <div class="col-75 scroll-div mainRow">
                    <table border="1" class="manufactureTable" sortable-func>
                        <tr>
                            <th class="monthTitle" style="line-height: 26px; border-left:1px solid #fff; border-top:1px solid #fff; border-bottom:1px solid #666; " colspan="{{month.days.length}}" ng-repeat="month in monthDays">{{month.name}}</th>
                        </tr>
                        <tr>
                            <th style="line-height: 26px;" ng-repeat="day in days track by $index" ng-if='viewWeekly == false'>{{getWeekDayShort(day)}}</th>
                        </tr>
                        <tr ng-repeat="order in finalArr" class="{{order.id}}" ng-if="checkYear(BOM.delivery) <= maxYear" ng-class-odd="'odd'" ng-class-even="'even'">
                            <td ng-repeat="day in days track by $index" id="{{order.id}}" data-day='{{day}}' class='{{day}}' ng-class="(getWeekDay(day) == 'Sunday' || getWeekDay(day) == 'Saturday')? 'holiday':'makeDroppable'" ng-if="BOM.components != ''">
                                <div id="{{day}}" ng-class="getCellColor(order.produce.startDate,order.produce.quantity.value)" ng-if="(checkDay(order.produce.startDate) == getDay(day)) && (checkMonth(order.produce.startDate) == getMonth(day)) && (checkYear(order.produce.startDate) == getYear(day))" data-weight='{{order.produce.quantity.value}}'>
                                    {{order.produce.quantity.value}}
                                </div>
                            </td>
                            <!--                                                <td ng-repeat="day in days track by $index" id="{{BOM.id}}" data-day='{{day}}' class='{{day}}' ng-class="(getWeekDay(day) == 'Sunday' || getWeekDay(day) == 'Saturday')? 'holiday':'makeDroppable'" ng-if="BOM.components == ''" style="width: 50px;height: 30px;">
                                                                                N
                                                                            </td>-->
                        </tr>
                        <tr class="totalWeightRow">
                            <td ng-repeat="day in days track by $index" data-date='{{day}}'>
                                &nbsp;
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </ion-content>
</ion-pane>